<html>
<head>
<meta charset="UTF-8">
<title>page map</title>
<body>
冊頁碼:
<input id="volpagenum" value="1.1b1"></input>
<button onclick="linetovolpage()"><<</button>
<button onclick="volpagetoline()">>></button>
絕對行數:
<input id="linenum" value="1"></input>
<br><hr width="100%"><br>
輸入冊頁碼:<input id="tofindrange_volpagenum" value="1.1b1"></input>
<button onclick="tofindrange()">冊頁碼範圍</button><br>
<span id="rangetop_volpage">

<script  language="JavaScript">
var bomponum=1;//
var linesperpage=8;// 1頁8行
var pagesperpiece=2;// 1張紙2頁

var linetovolpage=function(){
	var lineinput=document.getElementById("linenum").value;
	var totallines=parseInt(lineinput)+8;
	var a=totallines%linesperpage;
	var page,line,piece,side;
//	var line;
	if(a==0){
		page=totallines/linesperpage;
		line=linesperpage;
	}else{
		page=(totallines-a)/linesperpage+1;
		line=a;
	}
	a=page%pagesperpiece;
//	var piece;
//	var side;
	if(a==0){
		piece=page/pagesperpiece;
		side="b";
	}else{
		piece=(page-a)/pagesperpiece+1;
		side="a";
	}
//	console.log(piece,side,line);
	document.getElementById("volpagenum").value=bomponum+"."+piece+side+line;

}

var volpagetoline=function(){
	var volpageinput=document.getElementById("volpagenum").value;
	volpageinput=volpageinput.split('.');
	var volpage="00"+volpageinput[1];
	piece=volpage.substr(volpage.length-5,3);
	side=volpage.substr(volpage.length-2,1);
	line=volpage.substr(volpage.length-1,1);
//	console.log(piece,side,line);
	piece=parseInt(piece);
	line=parseInt(line);
	var page=(piece-1)*pagesperpiece;
	var totallines;
	if(side=="a"){
		if(page==0){
			totallines="not exist,start from 1.1b1";
		}else{
			page=page+0;
			totallines=page*linesperpage+line-8;
		}
	}else{
		page=page+1;
		totallines=page*linesperpage+line-8;
	}
//	console.log(totallines);
	document.getElementById("linenum").value=totallines;
}

</script>
</body>
</html>